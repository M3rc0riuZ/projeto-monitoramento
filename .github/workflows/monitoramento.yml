#name: Monitoramento de Logs
#
#on:
 # push:
    #branches:
   #   - main
  #schedule:
 #   - cron: '0 * * * *'  # Executa de hora em hora (pode mudar)

#jobs:
  #monitorar:
   # runs-on: ubuntu-latest

   # steps:
   # - name: Clonar o repositório
    #  uses: actions/checkout@v3

   # - name: Configurar Python
      #uses: actions/setup-python@v4
     # with:
    #    python-version: '3.10'

   # - name: Instalar dependências (se tiver)
    #  run: pip install -r requirements.txt || true

   # - name: Executar script de coleta
   #   run: python3 coletar_logs.py

  #  - name: Executar script de detecção
    #  run: python3 detectar_incidentes.py

   # - name: Commit e push dos resultados
     # run: |
    #    git config --global user.name "github-actions[bot]"
   #     git config --global user.email "github-actions@github.com"
  #      git add .
 #       git commit -m "Atualização automática via GitHub Actions" || echo "Sem alterações para commitar"
#        git push https://x-access-token:${{ secrets.GH_PAT }}@github.com/M3rc0riuZ/projeto-monitoramento.git HEAD:main




name: monitorar

on:
  push:
    branches:
      - main
  schedule:
    - cron: '0 * * * *'  # executa a cada hora

jobs:
  monitorar:
    runs-on: ubuntu-latest

    steps:
      - name: Clonar o repositório
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Instalar dependências
        run: |
          pip install -r requirements.txt

      - name: Executar script de coleta
        run: python coleta_logs.py

      - name: Executar script de detecção
        run: python detectar_incidentes.py

      - name: Configurar Git
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"

      - name: Adicionar token ao remote
        run: git remote set-url origin https://x-access-token:${{ secrets.GH_PAT }}@github.com/M3rc0riuZ/projeto-monitoramento.git

      - name: Commit e push dos resultados
        run: |
          git add .
          git commit -m "Atualização automática via GitHub Actions" || echo "Nada para commitar"
          git push origin main
